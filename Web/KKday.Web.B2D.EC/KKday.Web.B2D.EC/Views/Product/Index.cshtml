@using KKday.Web.B2D.EC.Models.Model.Product

@{
    ViewData["Title"] = "Product Page";

    var prodTitle = (ProdTitleModel)ViewData["prodTitle"];
    var prod = (ProductforEcModel)ViewData["prod"];
    var pkgs = (PackageModel)ViewData["pkgs"];
    var allCanUseDate = (string)ViewData["allCanUseDate"];
    var currency = (string)ViewData["currency"];

}


@section Scripts{

    <style type="text/css">
        .show {
            position: absolute;
            left: 800px;
            top: 200px;
            z-index: 99;
        }

        .disabledClass {
            pointer-events: none;
        }
    </style>
    @*<link href="@(Url.Content("~/css/jquery-ui-theme-redmond/jquery-ui-1.10.3.custom.css"))" rel="stylesheet" type="text/css" />*@
    @*<link href="@Url.Content("wwwroot/css/bootstrap.css")" rel="stylesheet" type="text/css" />*@


    @*
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>*@

    @*
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.1.min.js"></script>*@

    @*<script type="text/javascript" src="@(Url.Content("~/js/jquery-ui-1.10.3.custom.js"))"></script>
        <script type="text/javascript" src="@(Url.Content("~/js/jquery-ui.js"))"></script>*@
    <script src="~/lib/bootstrap/dist/js/bootstrap-datepicker.js"></script>
    <script type="text/javascript" src="@Url.Content("/js/prod.check.js")"></script>

    <script type="text/javascript">


            $(function () {
                setDatePicker();
                setInit();
            });

    </script>


}


<i class="icons minus-circle"></i>
<i class="fas fa-minus-circle"></i>
<i class="fal fa-minus-circle fa-w-16 fa-2x"></i>
<i class="fal fa-plus-circle fa-w-16 fa-2x"></i>
@Html.Hidden("hdnGuid", prod.guidNo)
@Html.Hidden("hdnCutOfDay", prod.before_order_day)
@Html.Hidden("hdnAllCanUseDate", allCanUseDate)
@Html.Hidden("hdnProdOid", prod.prod_no)
@Html.Hidden("hdnPkgOid", "")
@Html.Hidden("hdnChkflow", "0")
@Html.Hidden("hdnPreSelDate", "")
@Html.Hidden("hdnShowImmediately", "")
@Html.Hidden("hdnIsEcSale", prod.prod_mkt.is_ec_sale)

<div class="container" style=" text-align:left;">
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-8">
                <h3> @prod.prod_name </h3>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-8">
                @prodTitle.product_index_product_oid :@prod.prod_no
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-8">
                @prodTitle.product_index_product_oid :@prod.prod_no
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-8">
                @prodTitle.common_duration :@prod.durationStr
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-8">
                @prodTitle.common_location :
                @if (prod.countries != null)
                {
                    <label>@prod.countries[0].name</label>

                    @foreach (City c in prod.countries[0].cities)
                    {
                        <label>,@c.name</label>
                    }

                }

                @prod.locationCountry @prod.locationCity
            </div>
        </div>
    </div>

    @if (prod.guide_lang_list != null)
    {
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-8">
                    @prodTitle.common_guide_can_speak :
                    @foreach (GuideLanguage g in prod.guide_lang_list)
                    {
                        <span>@g.lang_name </span>
                    }
                </div>
            </div>
        </div>
    }
    <div class="row">
        <div class="col-md-12">
            <div class="col-md-6">
                @prod.introduction
            </div>
        </div>
    </div>

    @if (prod.prod_mkt.is_ec_sale == true)
    {
        <br />
        <div class="col-xs-6" style="clear: both;">
            <div class="col-xs-6">
                @prodTitle.product_index_option_title
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-3">
                    <div class="form-group">
                        <div class="input-group date" id='datepicker1' onclick="iniShowDate()">
                            <!--chgPkgInfo('','showDate')-->
                            <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                            <input type="text" id="selDate" class="form-control" placeholder="@prodTitle.product_index_select_date" readonly="readonly">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }




    <!--套餐區塊-->

    <div id="showPkg">
    </div>

    <div class="show">
        @await Html.PartialAsync("_booking_bar", prod)
    </div>

    <!--行程說明-->

    @prodTitle.common_experience <br />
    @prod.prod_desction <br />

    <!--行程表-->
    @if (prod.tour_list.Count > 0)
    {
        @prodTitle.common_timetable <br />

        @foreach (Tour t in prod.tour_list)
        {
            <span>@t.time_desc</span> <span>@t.tour_desc </span> <br />
        }
    }

    @prodTitle.product_index_price_detail <br />

    <!--費用包含-->
    @foreach (CostDetail c in prod.cost_detail_list)
    {
        @if (c.detail_type == "INC")
        {
            <span>@c.detail_desc</span> <br />
        }
    }

    <!--費用不包含-->
    @foreach (CostDetail c in prod.cost_detail_list)
    {
        @if (c.detail_type == "NO_INC")
        {
            <span>@c.detail_desc</span> <br />
        }
    }

    <!--憑證類型-->
    @if (prod.voucher_desc != "")
    {
        <span>@prodTitle.product_index_voucher_type</span> <br />
        <span>@prod.voucher_desc</span> <br />
    }


    <!--兌換地點-->
    @prodTitle.product_index_place  <br />
    <span style="color:red;">兌換地點還沒有做喔</span><br />

    @prodTitle.common_reminder <br />

    @if (prod.remind_list != null)
    {
        @foreach (Remind r in prod.remind_list)
        {
            <label>@r.remind_desc</label>
        }
    }

    <br /><br /><br /><br />
    @prodTitle.common_cancellation_policy <br />

    @if (@prod.policy_no == "1" || prod.policy_no == "2")
    {
        @prod.policyInfo < br />
    }
    else if (prod.policy_no == "3")
    {
        @prodTitle.common_cancel_date @prodTitle.common_cancellation_fee <br />

        @foreach (CancelPolicy policy in prod.cancelPolicyList)
        {
            <span>@policy.showRange  @policy.showPercent</span> <br />
        }

        <br />
        <span>@prodTitle.common_cancel_policy_explanation</span>
    }

</div>


@* 地圖部分 *@

<div class="info-section" id="map-spy">
    <h3 class="info-title">@prodTitle.common_map</h3>
    <div class="info-content">
        <!-- 若為機場接送類別 -->
        @if (true)
        {
            <h4 class="info-subtitle">機場集合地</h4>
            <ul class="map-info">
                <li>
                    <span>TPE - Terminal 1<br>1F</span>
                    <div class="map-img">
                        <div id="map_source"></div>
                    </div>
                </li>
                <li>
                    <span>TPE - Terminal 2<br>2F</span>
                    <div class="map-img">
                        <a href="http://www.google.com/maps/place/25.047923,121.51708/@@25.047923,121.51708,13z" target="_blank">
                            <img src="http://placehold.it/720x405?text=This is a map">
                        </a>
                    </div>
                </li>
            </ul>
        }


        <!--若非機場接送類別-->
        <h4 class="info-subtitle">@prodTitle.common_meeting_point</h4> <!-- 集合地 -->
        <!-- 一個大標內有多張地圖時 -->
        <ul class="map-info">
            <li v-if="venueSetting != null">
                @*<span v-if="venueSetting.venueType === '01'">*@
                @if (true)
                {
                    @*<span>{{ venueSetting.dataItems.meetingPointMap.mapAddress }}</span>*@
                }
                else
                {
                    @*<span>{{ venueSetting.dataItems.meetingPointImage.imageDesc }}</span>*@
                }

                <!-- 集合地圖片顯現 -->
                <div class="row">
                    <div class="col-md-12">
                        <!-- 地圖圖片型態 -->
                        @*<div v-if="venueSetting.venueType === '01'" class="map-img" :class="{'in':product.arrImgUrl.length > 0}">*@
                        @if (true)
                        {

                        }
                        <google-embed-map :map-information="venueSetting.dataItems.meetingPointMap">
                        </google-embed-map>
                    </div>
                    <div v-else class="map-img" :class="{'in':product.arrImgUrl.length > 0}">
                        <img :src="venueSetting.dataItems.meetingPointImage.imageUrl">
                    </div>
                </div>
    </div>
    </li>
    </ul>

    <!-- 主要目的地 -->
    <h4 class="info-subtitle">主要目的地</h4>
    <!-- 備註-->
    <p>
        7:15am JR 新宿站：地下S2出口上來 三菱東京UFJ銀行前
    </p>

    <ul class="map-info">
        <li>
            <span>平溪車站</span>
            <div class="map-img">
                <a href="http://www.google.com/maps/place/25.047923,121.51708/@@25.047923,121.51708,13z" target="_blank">
                    <img src="http://placehold.it/720x405?text=This is a map">
                </a>
            </div>
        </li>
        <li>
            <span>十分瀑布</span>
            <div class="map-img">
                <a href="http://www.google.com/maps/place/25.047923,121.51708/@@25.047923,121.51708,13z" target="_blank">
                    <img src="http://placehold.it/720x405?text=This is a map">
                </a>
            </div>
        </li>
        <li>
            <span>基隆廟口</span>
            <div class="map-img">
                <a href="http://www.google.com/maps/place/25.047923,121.51708/@@25.047923,121.51708,13z" target="_blank">
                    <img src="http://placehold.it/720x405?text=This is a map">
                </a>
            </div>
        </li>
        <li>
            <span>九份</span>
            <div class="map-img">
                <a href="http://www.google.com/maps/place/25.047923,121.51708/@@25.047923,121.51708,13z" target="_blank">
                    <img src="http://placehold.it/720x405?text=This is a map">
                </a>
            </div>
        </li>
    </ul>
</div>
                              </div>