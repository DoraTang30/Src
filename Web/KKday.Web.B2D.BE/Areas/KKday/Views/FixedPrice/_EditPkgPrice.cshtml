@using KKday.Web.B2D.BE.Models.Model.Common
@using KKday.Web.B2D.BE.Models.Model.FixedPrice
@using Resources
@inject ILocalizer localizer
@model List<FixedPricePackageEx>
@{
    var query_params = ViewData["QUERY_PARAMS"] as QueryParamsModel;
}

@if (Model == null || Model.Count < 1)
{
    <span>@localizer.Text.Data_Not_Found</span>
}
else
{


    <div class="row">
        <div class="col-xs-12 table-responsive">

            <table id="mytable" class="table table-striped fit">
                <thead>
                    <tr>
                        <th>套餐名稱</th>
                        <th>套餐條件</th>
                        <th>價格</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                @foreach (var pkg in Model)
                {
                    foreach (var price in pkg.Prices)
                    {
                        var seq = pkg.Prices.IndexOf(price);
                    <tr>
                        @if (seq == 0)
                        {
                        <td rowspan="@pkg.Prices.Count()">
                            <label>@pkg.PKG_NAME</label><br />
                            <span>@pkg.ONLINE_SDATE ~ @pkg.ONLINE_EDATE</span> 
                        </td>
                        }
                        <td>@price.PRICE_COND</td>
                        <td>@price.PRICE</td>
                        <td>
                            <button class="btn btn-warning btn-xs" data-title="Edit" data-toggle="modal" data-target="#edit">
                                <span class="glyphicon glyphicon-pencil"></span>
                            </button>

                            <button class="btn btn-danger btn-xs" data-title="Delete" data-toggle="modal" data-target="#delete">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </td>
                    </tr>   
                   }
                     
                }

                </tbody>
            </table>

        </div>
    </div>


    <div class="row">
        <div class="col-sm-12"> 

            <div class="form-inline"> 
                <div class="checkbox">
                   <input type="checkbox" id="checkall" style="margin-left: 16px; width: 30px; height: 30px;">
                </div> 
                <label for="checkall">Package Name</label>
            </div>

        </div>
    </div>
 
<script type="text/javascript">

    // Don't collapse on checkbox click
    $('.panel-heading h4 input[type=checkbox]').on('click', function(e) {
        e.stopPropagation();

        console.log(".panel-heading h4 input[type=checkbox] clicked");
    });

    // Cancel show event if not checked
    $('#collapseOne').on('show.bs.collapse', function(e) {
        if(!$('.panel-heading h4 input[type=checkbox]').is(':checked'))
        {
            return false;
        }
    }); 

    $("#checkall").click(function () {
        if ($(this).is(':checked')) {
            $("#accordion input[type=checkbox]").each(function () {
                $(this).prop("checked", true);
            });
            $("#btn_imp_pkg").prop('disabled', false);
        } else {
            $("#accordion input[type=checkbox]").each(function () {
                $(this).prop("checked", false);
            });
            $("#btn_imp_pkg").prop('disabled', true);
        }
    });

    $("#accordion input[type=checkbox]").click(function () {
        if (!$(this).is(':checked')) {
            $("#checkall").prop("checked", false);
        } 
    });


</script>
}
 